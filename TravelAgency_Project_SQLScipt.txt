1.Query to create a new table SAGENCYDATA

create table SAGENCYDATA as (select SBOOK.AGENCYNUM,
count(SBOOK.AGENCYNUM) as NUMBOOKINGS from SBOOK, STRAVELAG where
SBOOK.AGENCYNUM=STRAVELAG.AGENCYNUM group by SBOOK.AGENCYNUM order by
count(SBOOK.AGENCYNUM) desc)

2. Query to select the top 5 agencies

select top 5 SAGENCYDATA.AGENCYNUM,
STRAVELAG.NAME,SAGENCYDATA.NUMBOOKINGS from SAGENCYDATA inner join
STRAVELAG on SAGENCYDATA.AGENCYNUM = STRAVELAG.AGENCYNUM

3. Query to create STOPAGENCY table

create table STOPAGENCY as (select top 5 SAGENCYDATA.AGENCYNUM,
STRAVELAG.NAME,SAGENCYDATA.NUMBOOKINGS from SAGENCYDATA inner join
STRAVELAG on SAGENCYDATA.AGENCYNUM = STRAVELAG.AGENCYNUM)

4. Query to create SAGBOOKDAYS table

create table SAGBOOKDAYS as (select AGENCYNUM, dayname(ORDER_DATE) as
ORDERDAY, count(dayname(ORDER_DATE)) as DAYCOUNT from SBOOK group by
AGENCYNUM, dayname(ORDER_DATE))

5. Query to get the max booking days for each of the top 5 agencies

select SAGBOOKDAYS.AGENCYNUM, STOPAGENCY.NAME, SAGBOOKDAYS.ORDERDAY,
SAGBOOKDAYS.DAYCOUNT from SAGBOOKDAYS inner join STOPAGENCY on
SAGBOOKDAYS.AGENCYNUM=STOPAGENCY.AGENCYNUM where SAGBOOKDAYS.DAYCOUNT in
(select max(DAYCOUNT) from SAGBOOKDAYS group by AGENCYNUM) 